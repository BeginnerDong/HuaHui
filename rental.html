<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport"
			content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<meta name="renderer" content="webkit">
		<meta name="description" content="">
		<meta name="keywords" content="">
		<title>Find a Partner</title>
		<script type="text/javascript" src="./js/vue.js"></script>
		<script type="text/javascript" src="js/jquery.min.js"></script>
		<script type="text/javascript" src="js/base.js"></script>
		<script type="text/javascript" src="js/include.js"></script>
		<link type="text/css" rel="stylesheet" href="css/public.css">
		<link type="text/css" rel="stylesheet" href="css/orderNav.css">

		<link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
		<script src="https://unpkg.com/element-ui/lib/index.js"></script>

		<script type="text/javascript"
			src="https://api.map.baidu.com/api?v=2.0&ak=bIm3oK3DAoQdmLiLRIrCmWoDz30EPGOk&s=1"></script>
		<!-- <script type="text/javascript" src="https://api.map.baidu.com/api?v=3.0&ak=9XwBG0tPbEYXMM1wSICMZ70G5HFt1dRf&s=1"></script> -->
		<!-- <script type="text/javascript" src="js/echarts.min.js"></script> -->
		<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
		<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts-gl/dist/echarts-gl.min.js"></script>
		<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts-stat/dist/ecStat.min.js"></script>
		<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts/dist/extension/dataTool.min.js">
		</script>
		<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts/map/js/china.js"></script>
		<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts/map/js/world.js"></script>
		<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts/dist/extension/bmap.min.js"></script>

	</head>
	<style>
		[v-cloak] {
			display: none !important;
		}

		.el-pager li.active {
			color: #c11719;
		}

		.lease {
			min-height: 500px;
			overflow: hidden;
			padding: 50px 0 100px;
			position: relative;
		}

		.lease .allH1 {
			margin-bottom: 50px;
		}

		.lease .item {
			width: 50%;
			box-sizing: border-box;
			padding: 15px;
			overflow: hidden;
			float: left;
		}

		.lease .itemBox {
			width: 100%;
			margin: auto;
			box-shadow: 0 0 5px 5px rgba(0, 0, 0, 0.05);
			overflow: hidden;
			padding: 20px 60px;
			border-radius: 10px;
			display: flex;
			align-items: center;
			height: 260px;
			position: relative;
			transition: all 0.5s;
			box-sizing: border-box;
		}

		.lease .itemLogo {
			width: 20%;
			float: left;
		}

		.lease .itemCon {
			float: left;
			padding-left: 60px;
		}

		.lease .itemCon div {
			padding: 5px 0;
			display: flex;
			align-items: center;
		}

		.lease .itemCon div p {
			flex: 1;
			word-break: break-all;
		}

		.lease .itemCon div a {
			word-break: break-all;
		}

		/* .lease .itemMask{position: absolute;top: 0;left: 0;right: -110%;bottom: 0;background-color: rgba(0,0,0,0.03);margin: auto;transition: all 0.5s;width: 10%;height: 100%;}
		.lease .itemBox:hover .itemMask{right: 0;left: -110%;} */
		.lease .itemBox:hover {
			box-shadow: 0 0 10px 10px rgba(0, 0, 0, 0.05);
		}

		.echartsBox {
			width: 100%;
			min-height: 800px;
		}

		.selectBox {
			width: 300px;
			padding: 15px;
			background-color: #fff;
			margin: 15px;
			display: flex;
			flex-direction: column;
		}

		.sel_txt {
			font-size: 22px;
		}

		.selectBox select,
		.selectBox .select {
			background-color: #eee;
			border: none;
			border-bottom: 1px solid #adadad;
			height: 50px;
			width: 100%;
			padding-left: 10px;
			box-sizing: border-box;
			margin-top: 15px;
		}
		
		.elIput .el-input__inner{
			background-color: #eee;
			border: none;
			border-bottom: 1px solid #adadad;
			height: 50px;
			width: 100%!important;
			margin-top: 15px;
			border-radius: 0;
			line-height: 50px;
		}
		.elIput .el-input__suffix{
			line-height: 50px;
			margin-top:10px;
		}

		.el-cascader,.el-select {
			background-color: #eee;
			border: none;
			border-bottom: 1px solid #adadad;
			height: 50px;
			width: 100%;
			margin-top: 15px;
		}

		.el-cascader .el-input .el-input__inner,.el-select .el-input .el-input__inner {
			height: 50px;
			line-height: 50px;
		}
		
		.selectBox .select {
			display: flex;
			align-items: center;
		}

		.selectBox input {
			background-color: #eee;
			flex: 1;
			width: initial;
		}

		.selectBox .icon {
			width: 18px;
			height: 18px;
			margin: 0 10px;
		}

		.selectBox .select1 {
			border-top: 1px solid #adadad;
			margin-top: 20px;
			/* max-height: 300px; */
			overflow-y: auto;
			/* flex:1 */
		}

		.selectBox .select1 .t {
			padding-top: 15px;
		}

		.selectBox .select1 .t1 {
			padding: 15px 0;
			border-bottom: 1px solid #c7c7c7;
		}

		.selectBox .select1 .t2 {
			font-size: 14px;
		}

		.selectBox .select1 .t3 {
			font-size: 12px;
			color: #888;
			padding-top: 5px;
		}

		.select1::-webkit-scrollbar {
			width: 10px;
			height: 10px;
		}

		.select1::-webkit-scrollbar-thumb {
			transition: alll 0.3s;
			background-color: rgba(193, 193, 193, 0.1);
			background-clip: padding-box;
			border-width: 3px;
			border-color: transparent;
			border-style: solid;
			border-radius: 5px;
		}

		.select1::-webkit-scrollbar-thumb:hover {
			background-color: rgba(189, 189, 189, 0.3);
			background-clip: border-box;
		}

		@media only screen and (max-width: 1440px) {
			.lease .itemBox {
				height: 240px;
			}
		}

		@media only screen and (max-width: 1100px) {
			.lease .item {
				width: 100%;
			}

			.lease {
				padding: 30px 0 100px;
			}
		}

		@media only screen and (max-width: 700px) {
			.lease .itemBox {
				height: 200px;
				font-size: 12px;
			}

			.echartsBox {
				height: 600px;
			}

			.Rseach {
				position: absolute;
				right: 0;
			}
		}

		@media only screen and (max-width: 500px) {
			.echartsBox {
				height: 600px;
			}

			.selectBox {
				width: 180px;
			}

			.sel_txt {
				font-size: 16px;
			}

			.selectBox select,
			.selectBox .select {
				height: 30px;
			}

			.selectBox input {
				width: 100px;
			}

			.selectBox .icon {
				width: 15px;
				height: 15px;
				margin: 0 10px;
			}

			.selectBox .select1 {
				max-height: 200px;
			}
		}

		@media only screen and (max-width: 480px) {
			.lease .itemLogo {
				width: 100%;
				float: initial;
				margin-bottom: 10px;
			}

			.lease {
				padding: 20px 0 90px;
			}

			.lease .allH1 {
				margin-bottom: 30px;
			}

			.lease .item {
				padding: 10px 15px;
			}

			.lease .itemBox {
				height: auto;
				width: initial;
				padding: 10px;
				display: block;
			}

			.lease .itemCon {
				padding-left: 20px;
				float: initial;
			}
		}

		.el-cascader .el-input .el-input__inner,.el-select .el-input .el-input__inner {
			width: 100%;
			border-radius: 0;
			border: none;
		}
	</style>

	<body>
		<div id="app" v-cloak :style="language=='_e'?'letter-spacing:1px!important':''">
			<div class="headTop" id="headTop"></div>

			<include src="header.html"></include>

			<!-- 为 ECharts 准备一个定义了宽高的 DOM -->
			<div style="position: relative;">
				<div id="main" class="echartsBox" :style="{height:height+'px'}"></div>
				<div style="position: absolute;top: 0;">
					<div class="boxShaow borderB1 bg-white selectBox" style="max-height: 900px;" :style="{height:height-60+'px'}">
						<div class="sel_txt">{{language=='_e'?'Find A Partner':(language=='_f'?'尋找合作夥伴':'寻找合作伙伴')}}
						</div>
						<!-- <select id="currId">
							<option :value="0">{{language=='_e'?'All':(language=='_f'?'全部':'全部')}}</option>
							<option v-for="(item,index) in labelData" :key="index" :value="item.id">
								{{item['title'+language]}}
							</option>
						</select> -->
						<el-cascader style="width: 100%;" :options="areaData" v-model="area_id" clearable 
							:placeholder="language=='_e'?'Select the Region':(language=='_f'?'選擇區域':'选择区域')"
							:props="{ checkStrictly: true,label:'title'+language,value:'id',children:'child' }" clearable>
						</el-cascader>
						<div>
							<!-- v-on:keydown.enter="getMainData(true)" -->
							<!-- <input type="text" v-model="title1" /> -->
							<el-input class="elIput" v-model="title1" :placeholder="language=='_e'?'Enter Search (Company Name)':(language=='_f'?'輸入搜索（公司名稱）':'输入搜索（公司名称）')" clearable></el-input>
							<!-- <img class="icon" src="images/icon.png"> -->
						</div>

						<!-- <select id="currId1">
							<option :value="0">{{language=='_e'?'Main System':(language=='_f'?'主擴':'主扩')}}</option>
							<option v-for="(item,index) in arrData" :key="index" :value="item">
								{{item}}
							</option>
						</select> -->
						<el-select v-model="currId1" style="width: 100%;" clearable
						:placeholder="language=='_e'?'Loudspeaker System':(language=='_f'?'主擴':'主扩')">
							<el-option v-for="item in arrData" :key="item['title'+language]" :label="item['title'+language]"
						 	:value="item['title'+language]">
							</el-option>
						</el-select>

						<!-- <div class="select">
							<input type="text" v-model="title"
								:placeholder="language=='_e'?'Search content':(language=='_f'?'輸入搜索(調音台)':'输入搜索(调音台)')" />
							<img class="icon" src="images/icon.png">
						</div> -->
						<el-cascader style="width: 100%;" :options="mixerData" v-model="mixer_id" clearable
							:placeholder="language=='_e'?'Mixing System':(language=='_f'?'調音臺':'调音台')"
							:props="{ checkStrictly: true,label:'title'+language,value:'id',children:'child' }" clearable>
						</el-cascader>

						<div class="select hand" style="justify-content: center;" @click="getMainData(true)">
							{{language=='_e'?'Search':(language=='_f'?'搜索':'搜索')}}
						</div>

						<div class="select1">
							<div class="t">{{total}}{{language=='_e'?'result(s)':(language=='_f'?'個結果':'个结果')}}
							</div>
							<div class="t1 flex" v-for="(item,index) in mainData">
								<div class="pr-1" style="flex: 1;width: 100px;">
									<p class="t2">{{item['title'+language]}}</p>
									<p class="t3" :class="item.show?'':'avoidOverflow'">{{item['mainEX'+language]}}</p>
									<p class="t3" v-if="item.show">
										<span v-for="(v,i) in item.mixer" :key="i">{{v['title'+language]}}、</span>
									</p>
									<p class="t3" v-if="item.show">{{item['phone'+language]}}</p>
								</div>
								<div class="hand" style="font-size: 30px;" @click="item.show=!item.show">
									{{!item.show?'+':'-'}}
								</div>
							</div>
						</div>

						<div class="flex" style="padding-top: 15px;justify-content: center;">
							<el-pagination small @current-change="handleCurrentChange"
								:current-page.sync="paginate.currentPage" :page-size="paginate.pagesize"
								layout="prev, pager, next" :total="total">
							</el-pagination>
						</div>

					</div>
				</div>
			</div>

			<!-- <div class="lease w1660">
				<div class="allH1" style="display: flex;justify-content: space-between;">
					<h1 style="flex: 1;"><span
							:class="language=='_e'?'normal':''">{{language=='_e'?'Rental Agent':(language=='_f'?'租賃公司':'租赁公司')}}</span>
						{{language=='_e'?'':'Rental'}}
					</h1>
					<div class="Rseach" style="padding-top: 0;">
						<input type="text" v-on:keydown.enter="getMainData(true)" v-model="title"
							:placeholder="language=='_e'?'Search content':(language=='_f'?'請輸入你要搜索的主要設備':'请输入你要搜索的设备名称')" />
						<a @click="getMainData(true);"><img class="icon" src="images/icon.png"></a>
					</div>
				</div>

				<div class="w1100" style="padding-bottom: 10px;">
					<div class="orderNav flexCenter borderB1">
						<span class="tt flexCenter" style="cursor: pointer;" :class="currId==-1?'on':''"
							@click="currId=-1;getMainData(true);">{{language=='_e'?'All':(language=='_f'?'全部':'全部')}}</span>
						<span class="tt flexCenter" style="cursor: pointer;" :class="currId==item.id?'on':''"
							@click="currId=item.id;getMainData(true);" v-for="(item,index) in labelData"
							:key="index">{{item['title'+language]}}</span>
					</div>
				</div>

				<div class="item" v-for="(item,index) in mainData" :key="index">
					<div class="itemBox">
						<img :src="item&&item.mainImg&&item.mainImg[0]&&item.mainImg[0].url" class="itemLogo">
						<div class="itemCon">
							<div><span>{{language=='_e'?'Name of Company':(language=='_f'?'名稱':'名称')}}：</span>
								<p>{{item['title'+language]}}</p>
							</div>
							<div><span>{{language=='_e'?'Phone Number':(language=='_f'?'電話':'电话')}}：</span>
								<p>{{item['phone'+language]}}</p>
							</div>
							<div><span>{{language=='_e'?'Email':(language=='_f'?'郵箱':'邮箱')}}：</span>
								<p>{{item.description}}</p>
							</div>
							<div><span>{{language=='_e'?'Main System':(language=='_f'?'主擴':'主扩')}}：</span>
								<p>{{item['mainEX'+language]}}</p>
							</div>
							<div><span>{{language=='_e'?'Console System':(language=='_f'?'調音台':'调音台')}}：</span>
								<p>{{item['mixer'+language]}}</p>
							</div>
						</div>
						<div class="itemMask"></div>
					</div>
				</div>

				<div class="all-pages mgt30">
					<span class="no-prev flexCenter"><img data-type="back" @click="changePage" class="arrow"
							src="images/case-icon5.png"></span>
					<span v-for="item in pageArray" :class="item == paginate.currentPage?'on':''"
						@click="linkTo(item)">{{item}}</span>
					<span class="next flexCenter"><img class="arrow" data-type="next" @click="changePage"
							src="images/case-icon4.png"></span>
				</div>
			</div> -->


			<include src="footer.html"></include>

		</div>
	</body>


	<script type="text/javascript">
		var app = new Vue({
			el: '#app',
			data: function() {
				return {
					mainData: [],
					pageArray: [1],
					allPages: 0,
					paginate: {
						count: 0,
						currentPage: 1,
						pagesize: 6,
						is_page: true,
					},
					language: '',
					areaData: [],
					currId: 0,
					arrData: [{
						title: 'K1'
					}, {
						title: 'K2'
					}, {
						title: 'K3'
					}, {
						title: 'Kara II'
					}, {
						title: 'Kiva II'
					}, {
						title: 'A系列'
					}],
					mixerData: [],

					title: '',
					title1: '',
					currId1: '',

					total: 0,

					area_id: [],
					mixer_id: [],
					
					height:800
				}
			},

			created() {
				var self = this;
				// setTimeout(function(){
				// 	var h = document.getElementById("headTop").offsetHeight;
				// 	self.height = window.screen.height - h;
				// },1000)
				self.getLabelData();
				self.getMainLabelData();
				self.initLanguage(1);
				window.base.bus.$on('changelanguage', function(res) {
					self.language = res;
					self.initLanguage(2)
				});
			},

			methods: {

				handleCurrentChange: function(val) {
					console.log(`当前页: ${val}`);
					var self = this;
					self.paginate.currentPage = val;
					self.getMainData();
				},

				changeId: function() {
					var self = this;
					var id = document.getElementById("currId").value;
					console.log('id', id)
				},

				createEcharts: function(newData, location) {
					var self = this;
					// 基于准备好的dom，初始化echarts实例
					var myChart = echarts.init(document.getElementById('main'));
					// 指定图表的配置项和数据
					var convertData = function(data) {
						var res = [];
						for (var i = 0; i < newData.length; i++) {
							var geoCoord = [parseFloat(location[i].lng), parseFloat(location[i].lat)];
							if (geoCoord) {
								res.push({
									name: data[i].name,
									mainImg: data[i].mainImg,
									value: geoCoord.concat(data[i].value),
									description: data[i].description,
									phone: data[i].phone,
									mainEX: data[i].mainEX,
									mixer: data[i].mixer,
								});
							}
						}
						// console.log('res', res, data)
						return res;
					};
					var option = {
						title: {
							text: '',
							left: 'center'
						},
						tooltip: {
							confine: true,
							trigger: 'item',
							formatter(params) {
								// console.log('params', params.data)
								let firstParams = params.data;
								let sndParams = params[1]; //显示的小圆点
								let firstHtml =
									'<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;' +
									'height:10px;background-color:rgb(215,42,38)"></span>'
								let sndHtml =
									'<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;' +
									'height:10px;background-color:rgb(44,71,85)"></span>'

								if (firstParams.mainImg.length > 0) {
									return "<div style='display:flex;align-items:center'><img style='width:100px;height:100px' src=" +
										firstParams.mainImg[0].url +
										"><div style='color:#222;padding-left:5px;font-size:14px'>名称：" +
										firstParams.name +
										"<br>" + firstParams.phone +
										"<br>" + firstParams.description +
										"<br>" + firstParams.mainEX +
										"<br>" + firstParams.mixer + '</div></div>';
								} else {
									return "<div style='display:flex;align-items:center'><div style='color:#222;padding-left:5px;font-size:14px'>名称：" +
										firstParams.name +
										"<br>" + firstParams.phone +
										"<br>" + firstParams.description +
										"<br>" + firstParams.mainEX +
										"<br>" + firstParams.mixer + '</div></div>';
								}
							},
							// show: false
						},
						legend: {
							selectedMode: false,
							show: false
						},
						color: ['#c11719'],
						bmap: {
							center: [104.114129, 37.550339],
							zoom: 6,
							roam: true,
							mapType: 'china',
							mapStyle: {
								styleJson: [{
										featureType: 'water',
										elementType: 'all',
										stylers: {
											color: '#F8F5EC'
										}
									},
									{
										featureType: 'land',
										elementType: 'all',
										stylers: {
											color: '#DECBA0'
										}
									},
									{
										featureType: 'railway',
										elementType: 'all',
										stylers: {
											visibility: 'off'
										}
									},
									{
										featureType: 'highway',
										elementType: 'all',
										stylers: {
											color: '#fdfdfd'
										}
									},
									{
										featureType: 'highway',
										elementType: 'labels',
										stylers: {
											visibility: 'off'
										}
									},
									{
										featureType: 'arterial',
										elementType: 'geometry',
										stylers: {
											color: '#fefefe'
										}
									},
									{
										featureType: 'arterial',
										elementType: 'geometry.fill',
										stylers: {
											color: '#fefefe'
										}
									},
									{
										featureType: 'poi',
										elementType: 'all',
										stylers: {
											visibility: 'off'
										}
									},
									{
										featureType: 'green',
										elementType: 'all',
										stylers: {
											visibility: 'off'
										}
									},
									{
										featureType: 'subway',
										elementType: 'all',
										stylers: {
											visibility: 'off'
										}
									},
									{
										featureType: 'manmade',
										elementType: 'all',
										stylers: {
											color: '#d1d1d1'
										}
									},
									{
										featureType: 'local',
										elementType: 'all',
										stylers: {
											color: '#d1d1d1'
										}
									},
									{
										featureType: 'arterial',
										elementType: 'labels',
										stylers: {
											visibility: 'off'
										}
									},
									{
										featureType: 'boundary',
										elementType: 'all',
										stylers: {
											color: '#fefefe'
										}
									},
									{
										featureType: 'building',
										elementType: 'all',
										stylers: {
											color: '#d1d1d1'
										}
									},
									{
										featureType: 'label',
										elementType: 'labels.text.fill',
										stylers: {
											color: '#999999'
										}
									}
								]
							}
						},
						series: [{
							name: '公司信息',
							type: 'effectScatter',
							mapType: 'china',
							coordinateSystem: 'bmap',
							data: convertData(newData),
							symbolSize: function(val) {
								return 15;
							},
							encode: {
								value: 2
							},
							showEffectOn: 'render',
							rippleEffect: {
								brushType: 'stroke'
							},
							label: {
								formatter: '{b}',
								position: 'right',
								show: false
							},
							emphasis: {
								scale: true
							},
							zlevel: 1,
							show: false,
							itemStyle: {
								color: '#c11719',
								shadowBlur: 10,
								shadowColor: '#9a9a9a',
								borderJoin: 'miter'
							},
						}]
					};

					// 使用刚指定的配置项和数据显示图表。
					myChart.setOption(option);
					console.log('myChart', myChart, option)
				},

				initLanguage(type) {
					var self = this;
					var lang = localStorage.getItem('language');
					if (lang) {
						self.language = lang;
					} else {
						self.language = '';
					}
					if(type==2){
						location.reload();
					}
				},

				getMainLabelData() {
					var self = this;
					var postData = {};
					postData.searchItem = {
						type: 10
					};
					postData.order = {
						listorder: 'asc'
					};
					var callback = (res) => {
						if (res.info.data.length > 0) {
							self.arrData = res.info.data;
						}
					};
					window.base.labelGet(postData, callback);
				},

				getLabelData() {
					var self = this;
					var postData = {};
					postData.searchItem = {
						type: ['=', 8],
						id: ['not in', [121]]
					};
					postData.order = {
						listorder: 'asc'
					};
					var callback = (res) => {
						if (res.info.data.length > 0) {
							self.areaData = res.info.data[0].child;
							self.mixerData = res.info.data[1].child;
						}
						self.getMainData()
					};
					window.base.labelGet(postData, callback);
				},

				getMainData(isNew) {
					var self = this;
					var postData = {};
					if (isNew) {
						self.total = 0;
						self.mainData = [];
						self.paginate.currentPage = 1;
					}
					postData.searchItem = {
						type: 8
					};
					postData.getAfter = {
						area: {
							tableName: 'Label',
							middleKey: 'area_id',
							key: 'id',
							condition: '=',
							info: ['title', 'title_e', 'title_f']
						},
						mixer:{
							tableName: 'Label',
							middleKey: 'mixer_id',
							key: 'id',
							condition: 'FIND_IN_SET',
							type:'or',
							searchItem:{
								parentid:['not in',[166]]
							}
						}
					}
					postData.FIND_IN_SET = []
					if (self.area_id.length > 0) {
						postData.FIND_IN_SET.push({
							arr: self.area_id,
							key: 'area_id',
							type: 'and'
						})
					}
					if (self.mixer_id.length > 0) {
						postData.FIND_IN_SET.push({
							arr: self.mixer_id,
							key: 'mixer_id',
							type: 'and'
						})
					}
					if (self.currId1) {
						postData.FIND_IN_SET.push({
							arr: [self.currId1],
							key: 'mainEX' + self.language,
							type: 'or'
						})
						// postData.searchItem['mainEX' + self.language] = self.currId1;
					}
					// if (self.title) {
					// 	postData.searchItem['mixer' + self.language] = ['LIKE', ['%' + self.title + '%']]
					// }
					if (self.title1) {
						postData.searchItem['title' + self.language] = ['LIKE', ['%' + self.title1 + '%']]
					}
					postData.order = {
						listorder: 'desc'
					};
					postData.paginate = window.base.cloneForm(self.paginate);
					var callback = (res) => {
						var h = document.getElementById("headTop").offsetHeight;
						self.height = window.screen.height - h;
						if (res.info.data.length > 0) {
							for (var i = 0; i < res.info.data.length; i++) {
								res.info.data[i].show = false;
							}
							self.mainData = res.info.data;
							// self.mainData.push.apply(self.mainData, res.info.data);
							self.total = res.info.total;
							window.base.computePageArr(self);
							
						} else {
							alert('没有数据')
						};
						self.getCompanyInfo();
					};
					window.base.articleGet(postData, callback);
				},

				getCompanyInfo() {
					var self = this;
					var postData = {};
					postData.searchItem = {
						type: 8
					};
					postData.getAfter = {
						area: {
							tableName: 'Label',
							middleKey: 'area_id',
							key: 'id',
							condition: '=',
							info: ['title', 'title_e', 'title_f']
						},
						mixer:{
							tableName: 'Label',
							middleKey: 'mixer_id',
							key: 'id',
							condition: 'FIND_IN_SET',
							type:'or',
							searchItem:{
								parentid:['not in',[166]]
							}
						}
					}
					postData.FIND_IN_SET = []
					if (self.area_id.length > 0) {
						postData.FIND_IN_SET.push({
							arr: self.area_id,
							key: 'area_id',
							type: 'and'
						})
					}
					if (self.mixer_id.length > 0) {
						postData.FIND_IN_SET.push({
							arr: self.mixer_id,
							key: 'mixer_id',
							type: 'and'
						})
					}
					if (self.currId1) {
						postData.FIND_IN_SET.push({
							arr: [self.currId1],
							key: 'mainEX' + self.language,
							type: 'or'
						})
						// postData.searchItem['mainEX' + self.language] = self.currId1;
					}
					if (self.title1) {
						postData.searchItem['title' + self.language] = ['LIKE', ['%' +
							self.title1 + '%'
						]]
					}
					var callback = (res) => {
						var newData = [];
						var location = [];
						if (res.info.data.length > 0) {
							var data = res.info.data;
							data.forEach((item, index) => {
								// console.log('item.lng && item.lat', item.lng, item.lat)
								var tit1 = self.language == '_e' ? 'Phone Number' : (self.language ==
									'_f' ? '電話' : '电话');
								var tit2 = self.language == '_e' ? 'Email' : (self.language == '_f' ?
									'郵箱' : '邮箱');
								var tit3 = self.language == '_e' ? 'Main System' : (self.language ==
									'_f' ? '主擴' : '主扩');
								var tit4 = self.language == '_e' ? 'Console System' : (self.language ==
									'_f' ? '調音台' : '调音台');
								var mixer = [];
								if(item.mixer.length>0){
									item.mixer.forEach((v,i)=>{
										mixer.push(v['title'+self.language])
									})
								}
								if (item.lng && item.lat) {
									newData.push({
										name: item['title' + self.language],
										mainImg: item.mainImg,
										phone: tit1 + ': ' + item['phone' + self.language],
										description: tit2 + ': ' + item['description' + self
											.language],
										mainEX: tit3 + ': ' + item['mainEX' + self.language],
										mixer: tit4 + ': ' + mixer.join('、'),
										value: 0
									})
									location.push({
										lng: parseFloat(item.lng),
										lat: parseFloat(item.lat)
									})
								}
							})
							console.log('newData', newData, location)
						};
						setTimeout(function() {
							self.createEcharts(newData, location);
						}, 1000)
					};
					window.base.articleGet(postData, callback);
				},

				linkTo(item) {
					var self = this;
					console.log(item);
					self.linkPage = item;
					window.base.linkTo(self);
					window.scrollTo(0, 0);
					console.log(self.pageArray)
				},

				changePage(e) {
					var self = this;
					var dataSet = window.base.getDataSet(e);
					console.log('232')
					window.base.changePage(dataSet, self);
					window.scrollTo(0, 0);
				},

			}
		});
	</script>
	<style>
		</html>
